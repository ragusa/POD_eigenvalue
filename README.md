# POD eigenvalue
POD for neutron diffusion criticality eigenproblems.  

## Purpose
This small code examplifies some issues observed when using projection-based model-order reduction for the multigroup neutron diffusion equations.

Two Reduced-Order Models (ROM) are considered. Both of them use snapshopts (multigroup flux slutions) generated by varying the cross-section values. 
*  the first ROM (ROM-1) performs an SVD decomposition on the full snapshot matrix
*  the second ROM (ROM-2) performs two SVD decompositions, one per energy group but using exactly the same snapshots as ROM-1

Then, both ROMs perform a Galerkin projection to obtained the reduced eigenvalue problem.

The reduced eigenproblem of ROM-1 often has large errors when compared to the Full-Order Model (FOM) solution. ROM-1 never exhibits such errors. To further analyze this, we decided 
* to never truncate the ROMS (that is the ROM rank is always equal to the number of snapshots used)
* to test the ROMs on the training set (expecting machine precision errors only).
 
More details can be found in the following paper <span style="color:blue">Add reference when published</span>.

## Provided test case
For our test case, we use the 3D LWR core benchmark data found in the Argonne benchmark problem book:
R. R. Lee, D. A. Maneley, B. Micheelsen, D. R. Vondy, M. R. Wagner, W. Werner, Multi-dimensional (x-y-z) LWR Model, ANL-7416 supplement 2, benchmark problem 11, Argonne National Laboratory, Illinois, USA (1977).  

<img src="core.PNG" alt="drawing" width="500"/>

A finite-element model of the problem has been built using the open-source FEM library [deal.ii](https://www.dealii.org), version 9.0.1.


## Codes

Four files are included:
1. ```build_full_system_matrix.m``` 

Given a set of material properties, the matrices for full system are assembled using region-dependent elementary matrices, as follows:  

<img src="mat_assembly.png" alt="drawing" width="500"/>


2. ```generate_snapshots_lhs.m```

Varies the nominal parameters; samples them using Latin Hypercube; generate as many snapshots are requested and save them in a file.

Four series of snapshots are provided if you do not want to re-generate them.


3. ```pod_test_anucen.m```

For a given training data point (i.e., a set of material properties used to generate the FOM snapshot), compute the ROM-1 and ROM-2
 
4. ```pod_check_driver.m```

Driver to go through of all the training data point and compare FOM, ROM-1, and ROM-2.

## License
GNU GPLv3